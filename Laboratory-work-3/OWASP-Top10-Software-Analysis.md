# Аналіз вразливостей програмного продукту за OWASP Top 10 2021

**Програмний продукт**: Система віддаленого керування ПЛК та частотними перетворювачами  
**Архітектура**: Web-застосунок (React Frontend + Node.js Backend + MySQL Database + Modbus TCP)

## Аналіз вразливостей за OWASP Top 10 2021

| Ідентифікатор та назва атаки (вразливості) | Вимога (FR, NFR) | Приклад вразливостей, які може використовувати атака | Приклад запобігання успішної реалізації атаки |
|-------------------------------------------|------------------|---------------------------------------------------|-------------------------------------------|
| **A1 - Broken Access Control** (Недоліки контролю доступу) | FR: Автентифікація користувачів системи | - Обхід авторизації через пряме посилання на URL<br>- Підвищення привілеїв користувача<br>- Доступ до чужих ПЛК без перевірки прав | - Впровадження Role-Based Access Control (RBAC)<br>- Перевірка авторизації на кожному запиті<br>- Логування всіх дій користувачів |
| **A2 - Cryptographic Failures** (Невдачі у криптографії) | NFR: Шифрування даних при передачі | - Слабкі алгоритми шифрування (DES, MD5)<br>- Зберігання паролів у відкритому вигляді<br>- Відсутність HTTPS для Modbus даних | - Використання сучасних алгоритмів (AES-256)<br>- Хешування паролів з salt (bcrypt, scrypt)<br>- TLS 1.3 для всіх з'єднань |
| **A3 - Injection** (Впровадження) | FR: Читання/запис параметрів пристроїв | - SQL-ін'єкції через параметри ПЛК<br>- NoSQL-ін'єкції в MongoDB запитах<br>- Command injection через Modbus команди | - Параметризовані запити (Prepared Statements)<br>- Валідація та санітизація всіх входів<br>- Принцип найменших привілеїв для БД |
| **A4 - Insecure Design** (Небезпечний дизайн) | NFR: Архітектура системи безпеки | - Відсутність безпечних паттернів проектування<br>- Незахищені бізнес-логіки керування ПЛК<br>- Відсутність threat modeling | - Security by Design підхід<br>- Регулярне проведення threat modeling<br>- Безпечні архітектурні паттерни |
| **A5 - Security Misconfiguration** (Неправильна конфігурація безпеки) | NFR: Конфігурація безпеки системи | - Стандартні паролі для ПЛК<br>- Відкриті debug endpoints<br>- Непотрібні сервіси та порти | - Зміна стандартних паролів<br>- Вимкнення debug в продакшні<br>- Принцип мінімальної конфігурації |
| **A6 - Vulnerable and Outdated Components** (Вразливі та застарілі компоненти) | NFR: Оновлення системи без зупинки | - Застарілі бібліотеки React/Node.js<br>- Вразливості в Modbus бібліотеках<br>- Непропатчені ПЛК firmware | - Регулярні оновлення залежностей<br>- Автоматичне сканування вразливостей<br>- Планове оновлення firmware ПЛК |
| **A7 - Identification and Authentication Failures** (Помилки ідентифікації та аутентифікації) | FR: Управління користувачами та правами доступу | - Слабкі паролі користувачів<br>- Відсутність MFA для критичних операцій<br>- Session hijacking | - Політика сильних паролів<br>- Впровадження Multi-Factor Authentication<br>- Безпечне управління сесіями |
| **A8 - Software and Data Integrity Failures** (Невдачі у забезпеченні цілісності ПЗ та даних) | FR: Збереження історії змін параметрів | - Підміна параметрів ПЛК під час передачі<br>- Відсутність перевірки цілісності конфігурацій<br>- Небезпечна десеріалізація JSON даних | - Цифрові підписи для критичних даних<br>- Checksums для конфігурацій ПЛК<br>- Безпечна серіалізація/десеріалізація |
| **A9 - Security Logging and Monitoring Failures** (Невдачі реєстрації та моніторингу безпеки) | NFR: Логування всіх операцій | - Відсутність логів критичних операцій<br>- Неможливість виявити атаку на ПЛК<br>- Відсутність алертів при підозрілій активності | - Централізоване логування (ELK Stack)<br>- Real-time моніторинг аномалій<br>- Автоматичні алерти при інцидентах |
| **A10 - Server-Side Request Forgery (SSRF)** (Підробка запитів на стороні сервера) | FR: Віддалене підключення до ПЛК та ПЧ | - Атаки на внутрішню мережу через SSRF<br>- Несанкціонований доступ до Modbus пристроїв<br>- Зондування внутрішньої інфраструктури | - Валідація та фільтрація URL-адрес<br>- Network segmentation для ПЛК<br>- Whitelist дозволених IP-адрес |
